# –¢–ï–ö–£–©–ò–ï –ó–ê–î–ê–ß–ò

## –°–¢–ê–¢–£–°

**–ê–ö–¢–ò–í–ù–ê–Ø –ó–ê–î–ê–ß–ê:** –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ API –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –¥–∞–π–≤-—Å–∞–π—Ç–æ–≤

## üéØ –¢–ï–ö–£–©–ê–Ø –ó–ê–î–ê–ß–ê

### –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ API –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –¥–∞–π–≤-—Å–∞–π—Ç–æ–≤

**–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∞—Å—à–∏—Ä–∏—Ç—å API endpoint `/api/dive-sites` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** Level 2 (Simple Enhancement)

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:** PLAN —Ä–µ–∂–∏–º - –î–µ—Ç–∞–ª—å–Ω–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

#### üìã –ß–ï–ö–õ–ò–°–¢ –ó–ê–î–ê–ß–ò

- [x] **VAN –∞–Ω–∞–ª–∏–∑** ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
- [x] **PLAN —Ä–µ–∂–∏–º** ‚úÖ –í –ü–†–û–¶–ï–°–°–ï
- [ ] **CREATIVE —Ä–µ–∂–∏–º** - –î–∏–∑–∞–π–Ω —Ä–µ—à–µ–Ω–∏–π
- [ ] **VAN QA** - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
- [ ] **IMPLEMENT —Ä–µ–∂–∏–º** - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
- [ ] **QA —Ä–µ–∂–∏–º** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] **REFLECT —Ä–µ–∂–∏–º** - –†–µ—Ñ–ª–µ–∫—Å–∏—è
- [ ] **ARCHIVE —Ä–µ–∂–∏–º** - –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

####Ô∏è –î–ï–¢–ê–õ–¨–ù–´–ô –ü–õ–ê–ù –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫:**
- Framework: Next.js 15 (App Router)
- Database: Supabase (PostgreSQL)
- Language: TypeScript
- API: Next.js API Routes
- ORM: Supabase Client

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è:**
- [x] –ü—Ä–æ–µ–∫—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω (Next.js + Supabase)
- [x] –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- [x] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–∞
- [x] –ë–∞–∑–æ–≤—ã–π API endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –¢–µ—Å—Ç–æ–≤–∞—è —Å–±–æ—Ä–∫–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π

#### –ü–û–î–ó–ê–î–ê–ß–ò

**1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ TypeScript —Ç–∏–ø–æ–≤**
- [ ] –°–æ–∑–¥–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `DiveSitesFilters`
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø—ã –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `src/types/database.ts`

**2. –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è API endpoint**
- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É query –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ `GET` —Ñ—É–Ω–∫—Ü–∏—é
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- [ ] –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è SQL –∑–∞–ø—Ä–æ—Å–∞
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `src/app/api/dive-sites/route.ts`

**3. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏**
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫ –ø–æ ID –¥–∞–π–≤-—Å–∞–π—Ç–∞ (—Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ)
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ ID –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —á–∏—Å–ª–æ–≤—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã "–æ—Ç –∏ –≤—ã—à–µ"
- [ ] –î–æ–±–∞–≤–∏—Ç—å JOIN'—ã –¥–ª—è —Ä–µ–≥–∏–æ–Ω–æ–≤ –∏ –ª–æ–∫–∞—Ü–∏–π

**4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
- [ ] –°–æ–∑–¥–∞—Ç—å unit —Ç–µ—Å—Ç—ã –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å edge cases

**5. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
- [ ] –û–±–Ω–æ–≤–∏—Ç—å API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### üîß –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ï –†–ï–®–ï–ù–ò–Ø

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤:**
```typescript
interface DiveSitesFilters {
  id?: string;                 // –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ø–æ UUID
  country_id?: number;         // –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
  region_id?: number;          // –ß–µ—Ä–µ–∑ —Å–≤—è–∑—å countries
  location_id?: number;        // –ß–µ—Ä–µ–∑ site_locations
  site_type_id?: number;       // –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
  difficulty_id?: number;      // –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
  depth_max_min?: number;      // >= –∑–Ω–∞—á–µ–Ω–∏–µ
  visibility_min?: number;     // >= –∑–Ω–∞—á–µ–Ω–∏–µ
  rating_min?: number;         // >= –∑–Ω–∞—á–µ–Ω–∏–µ
  status?: 'draft' | 'published' | 'rejected';
}
```

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –ø–æ–∏—Å–∫–∞ –ø–æ ID –≤–º–µ—Å—Ç–æ –∏–º–µ–Ω–∏:**
- **UUID —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å:** –ö–∞–∂–¥—ã–π –¥–∞–π–≤-—Å–∞–π—Ç –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π UUID
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ü–æ–∏—Å–∫ –ø–æ UUID –±—ã—Å—Ç—Ä–µ–µ —á–µ–º ILIKE –ø–æ –∏–º–µ–Ω–∏
- **–¢–æ—á–Ω–æ—Å—Ç—å:** –ò—Å–∫–ª—é—á–∞–µ—Ç –ø—É—Ç–∞–Ω–∏—Ü—É —Å –ø–æ—Ö–æ–∂–∏–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏
- **API –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å:** –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
- **–ü—Ä–∞–∫—Ç–∏—á–Ω–æ—Å—Ç—å:** ID —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ URL –∏ —Å—Å—ã–ª–∫–∞—Ö

**SQL –∑–∞–ø—Ä–æ—Å —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π:**
```sql
SELECT sites.*, countries.*, site_types.*, difficulties.*
FROM sites
LEFT JOIN countries ON sites.country_id = countries.id
LEFT JOIN site_types ON sites.site_type_id = site_types.id
LEFT JOIN difficulties ON sites.difficulty_id = difficulties.id
LEFT JOIN site_locations ON sites.id = site_locations.site_id
WHERE 
  (id = ? OR id IS NULL)
  AND (country_id = ? OR country_id IS NULL)
  AND (region_id = ? OR region_id IS NULL)
  AND (location_id = ? OR location_id IS NULL)
  AND (site_type_id = ? OR site_type_id IS NULL)
  AND (difficulty_id = ? OR difficulty_id IS NULL)
  AND (depth_max >= ? OR depth_max IS NULL)
  AND (visibility >= ? OR visibility IS NULL)
  AND (rating >= ? OR rating IS NULL)
  AND (status = ? OR status IS NULL)
```

#### ‚ö†Ô∏è –í–´–ó–û–í–´ –ò –†–ï–®–ï–ù–ò–Ø

**–í—ã–∑–æ–≤ 1: –°–ª–æ–∂–Ω–æ—Å—Ç—å SQL –∑–∞–ø—Ä–æ—Å–∞**
- **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ WHERE —É—Å–ª–æ–≤–∏–π
- **–ú–∏—Ç–∏–≥–∞—Ü–∏—è:** –°–æ–∑–¥–∞—Ç—å helper —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞

**–í—ã–∑–æ–≤ 2: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ JOIN'–∞–º–∏**
- **–†–µ—à–µ–Ω–∏–µ:** –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å, –¥–æ–±–∞–≤–ª—è—Ç—å JOIN'—ã —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- **–ú–∏—Ç–∏–≥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

**–í—ã–∑–æ–≤ 3: –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤**
- **–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å —á–µ—Ç–∫–∏–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –æ–± –æ—à–∏–±–∫–∞—Ö
- **–ú–∏—Ç–∏–≥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Zod –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏

#### ‚úÖ –ö–†–ò–¢–ï–†–ò–ò –ì–û–¢–û–í–ù–û–°–¢–ò

- [ ] API –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Å–µ 10 —Ç–∏–ø–æ–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- [ ] –ü–æ–∏—Å–∫ –ø–æ ID –¥–∞–π–≤-—Å–∞–π—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (—Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ)
- [ ] –ß–∏—Å–ª–æ–≤—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ "–æ—Ç –∏ –≤—ã—à–µ" (>=)
- [ ] –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ä–µ–≥–∏–æ–Ω—É –∏ –ª–æ–∫–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ JOIN'—ã
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- [ ] Unit —Ç–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
- [ ] API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞

#### –ö–û–ú–ü–û–ù–ï–ù–¢–´, –¢–†–ï–ë–£–Æ–©–ò–ï CREATIVE –†–ï–ñ–ò–ú–ê

**–ù–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, —Ç—Ä–µ–±—É—é—â–∏—Ö CREATIVE —Ä–µ–∂–∏–º–∞**
- –í—Å–µ —Ä–µ—à–µ–Ω–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –¥–ª—è API —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å—Ö–µ–º–æ–π –ë–î
- UI/UX —Ä–µ—à–µ–Ω–∏—è –Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è –Ω–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ

#### –í–†–ï–ú–ï–ù–ù–´–ï –û–¶–ï–ù–ö–ò

- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤:** 30 –º–∏–Ω—É—Ç
- **–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è API:** 2 —á–∞—Å–∞
- **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:** 3 —á–∞—Å–∞
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** 1.5 —á–∞—Å–∞
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** 30 –º–∏–Ω—É—Ç

**–û–±—â–µ–µ –≤—Ä–µ–º—è:** ~7.5 —á–∞—Å–æ–≤

---

**–ü–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞:** –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase API  
**–ê—Ä—Ö–∏–≤:** [archive-supabase-api-setup.md](./archive/archive-supabase-api-setup.md)
